<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <title>🛒 Keranjang Saya</title>
        <link rel="stylesheet" th:href="@{/css/userdash.css}">
    </head>

    <body>
        <div class="sidebar">
            <h2>🍰 User Menu</h2>
            <ul>
                <li th:each="kategoriItem : ${categories}">
                    <a th:href="@{|/user/kategori/${kategoriItem}|}" th:text="${kategoriItem}">Kategori</a>
                </li>
                <li><a href="/user/orderan">🛒 Keranjang Saya</a></li>
                <li>
                    <form th:action="@{/logout}" method="post" style="display:inline;">
                        <button type="submit" class="logout-button">🔙 Logout</button>
                    </form>
                </li>
            </ul>
        </div>
        <div class="main-content">
            <h1>🛒 Keranjang Anda</h1>

            <div th:if="${cartItems.empty}">
                <p>Keranjang Anda kosong.</p>
            </div>

            <div th:unless="${cartItems.empty}">
                <table class="order-table">
                    <thead>
                        <tr>
                            <th>Produk</th>
                            <th>Varian / Ukuran</th>
                            <th>Jumlah</th>
                            <th>Harga Satuan</th>
                            <th>Subtotal</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="item : ${cartItems}">
                            <td th:text="${item.product.nama}">Nama Produk</td>
                            <td th:text="${item.opsi}">Varian</td>
                            <td th:text="${item.quantity}">1</td>
                            <td th:text="'Rp ' + ${#numbers.formatDecimal(item.product.harga, 0, 2, 'COMMA')}">Rp 0</td>
                            <td th:text="'Rp ' + ${#numbers.formatDecimal(item.quantity * item.product.harga, 0, 2, 'COMMA')}">Rp 0</td>
                            <td>
                                <form th:action="@{|/user/cart/delete/${item.id}|}" method="post">
                                    <button type="submit" class="btn-hapus">🗑 Hapus</button>
                                </form>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="total-box">
                    <strong>Total: </strong>
                    <span th:text="'Rp ' + ${#numbers.formatDecimal(total, 0, 2, 'COMMA')}">Rp 0</span>
                </div>

                <form th:action="@{/user/checkout}" method="post">
                    <button type="submit" class="btn-checkout">✅ Lanjut Checkout</button>
                </form>
            </div>
        </div>
    </body>
</html>